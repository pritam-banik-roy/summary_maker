let topWords=[];const stopWords=["I","me","mine","myself","we","us","ourselves ","ours","our","you","your","yours ","yourself","yourselves ","he","himself","it","its","itself","they","them ","their ","theirs ","themselves ","what","which","who","whom","this","that","these","those","am","is","are","was","were","be","been","being","have","has","had","having","do","does","did","doing","i'm","you're","he's","she's","it's","we're","they're","i've","you've","we've","they've","i'd","you'd","he'd","she'd","we'd","they'd","i'll","you'll","she'll","we'll","they'll","isn't","aren't","wasn't","weren't","hasn't","haven't","hadn't","doesn't","don't","didn't","won't","wouldn't","shan't","shouldn't","can't","cannot","couldn't","mustn't","let's","that's","who's","what's","here's","there's","when's","where's","why's","how's","a","an","and","but","if","or","because","as","until","while","of","at","by","for","with","about","against","between","into","through","during","before","after","above","below","to","from","up","down","in","out","on","off","over","under","again","then","once","here","there","when","why","how","all","any","both","each","few","more","most","other","some","such","no","nor","not","only","own","same","so","than","too","very","a","the","The","IT","it"];let characterCount=0,summaryCount=0;function summary_legacy(e){characterCount=e.length,topWords=getTopNWords(e,4);for(var t=[],o=e.split(/\n/).filter(e=>""!==e),n=0;n<o.length;n++)t.push(paragraphSummary(o[n]));var r=t.join("\n");return summaryCount=r.length,"KEYWORDS: ".concat(topWords.join(", ")+"\n ======================================================================================================\n"+r)}function paragraphSummary(e){var t,o=new Map([]),n=0,r=null;return e=(e=(e=(e=(e=(e=(e=(e=e.split("U.S.").join("US")).split("Dr.").join("Dr")).split("Mr.").join("Mr")).split("Ms.").join("Ms")).split("Mrs.").join("Mrs")).split("Sen.").join("Senator")).replace(/\.\)/,").")).replace(/[\d]+\./gi,""),function(e){for(var t=0;t<e.length;t++){var n=s(e[t],stopWords);o.set(n,e[t])}}((t=e.replace(/(\.+|\!|\?)(\"*|\'*|\)*|}*|]*)(\s|\n|\r|\r\n)/gm,"$1|").split("|"),r=t[0],t.shift(),n=t.length-1,t)),(r+" ").concat(function(){for(var e=[],t=0;t<Math.ceil(n/3)-1;t++){var r=Math.max(...o.keys());e.push(o.get(r)),o.delete(r)}return e}().join(" "));function s(e,t){for(var o=0,n=0;n<t.length;n++)e.includes(t[n])||o++;for(n=0;n<topWords.length;n++)return e.includes(t[n])&&(o++,o++),o}}function getTopNWords(e,t){for(var o,n=/\w+(?:'\w{1,2})?/g,r={},s=0;s<stopWords.length;s++)e=e.split(" "+stopWords[s]+" ").join("");for(;null!=(o=n.exec(e));){void 0===r[h=o[0].toLowerCase()]?r[h]=1:r[h]++}var a=[];for(var h in r)r.h`asOwnProperty(h)&&a.push([h,r[h]]);a.sort(function(e,t){return t[1]-e[1]});var i=[];for(s=0;s<t;s++)i.push(a[s][0]);for(s=0;s<i.length-1;s++)"s"===i[s]&&i.splice(s,1);return i}function replaceAll(e,t,o){return e.replace(new RegExp(escapeRegExp(t),"g"),o)}